<link rel="stylesheet" href="/css/home.css">
<h1>SocialBuzz |<%=title%></h1>
        
<section id="feed-post">

    <h4>Posts</h4>

    <% if(locals.user){ %>

    <form action="/posts/create" method="post">
        <textarea name="content" id="new_post_form" cols="30" rows="5" placeholder="Heyy.. What's on your mind!! Share it with your friends"></textarea>
        <input type="submit" value="Make a new Post">
    </form>

    <%}%>

    <div id="post-container">
        <ul>
            <% for(post of posts){ %>
                <li>
                     <% if (locals.user && locals.user.id==post.user.id){ %>
                    <a href="posts/delete/<%=post.id%>">X</a>
                    <%}%>
                    <p><%=post.content%></p>
                    
                    <small><%=post.user.name%></small>
                </li>
                    <div class="comments_form">

                        <% if(locals.user){ %>

                        <form action="/comments/create" method="post">
                            <input type="text" name="content" required placeholder="Add a comment" >
                            <input type="hidden" name="post" value="<%=post._id%>">
                            <input type="submit" value="Add a comment">
                        </form>

                        <%}%>
                    </div>
                    <ul>
                        <div class="comments_container">
                            <% for(comment of post.comments){ %>
                                <li>
                                    <% if(locals.user&&locals.user.id==comment.user.id){ %>
                                        <a href="/comments/delete/<%=comment._id%>">X</a>
                                    <%}%>
                                    <span><%=comment.content%></span>
                                    <small><%=comment.user.name%></small>
                                </li>
                            <%}%>
                        
                        </div>
                    </ul>
                
            <%}%>

        </ul>
    </div>

</section>